# Waterwheel Monitoring System

Program to monitor frequency of power generated by waterwheel

Prints frequency every 1.8 seconds along with an 18 second moving average
Waterwheel rotates at approx 10rpm ie 6sec per rotation

Program for monitoring frequency from RS PRO 1 Phase Backlit LCD Energy Meter, Type Energy Meter RS Stock No. 236-9298
Interface via Modbus

Reference: Modbus Guide (aka ICD)
RS PRO DIN Rail Multifunction Power Meter
MID Certified
Stock No: 236-9298

Underspeed threshold at 44.5Hz average and overspeed threshold at 48.5Hz average, with audio warning when either of these thresholds are crossed.

## Dependencies
- MinGW-W64
- G++
- CMake >= 3.22

These can be installed on Linux with the following commands:

    $ sudo apt-get update -y
    $ sudo apt-get upgrade -y
    $ sudo apt-get install mingw-w64
    $ sudo apt-get install cmake
    $ sudo apt-get install g++


## Compilation

This project is written for use on Windows, but is built using cross compilation on Linux.

To build the project, run the following commands from the project root:

    $ mkdir build
    $ cd build
    $ cmake ..
    $ make


The output executable can be found and ran (on Windows) here, substituting `{revision}` with the build's revision number:

    $ ./bin/waterwheel_monitor_{revision}

To run the program in debug mode, add the flag `-d` when running.

## Code Style

This project follows the [Google C++ Style Guide](https://google.github.io/styleguide/cppguide.html), and all code written for this project should follow these guidelines.

## References

- https://batchloaf.wordpress.com/2013/02/13/writing-bytes-to-a-serial-port-in-c/   writing data
- https://gist.github.com/uilianries/2a5ee873f1064efb192a6f4ea016a3c0   for reading data
- https://ideone.com/ridffw char to float conversion
- https://stackoverflow.com/questions/51409965/convert-char-to-float-using-union-or-memcpy char to float conversion
- https://www.geeksforgeeks.org/time-delay-c/  for time delays
- https://www.scadacore.com/tools/programming-calculators/online-checksum-calculator/ for checksum calculations
